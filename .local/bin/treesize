#!/usr/bin/env php
<?php 

function do_scan($dir) {
    $total = 1;

    if (is_dir($dir) && !is_link($dir) ) {
        foreach (scandir($dir) as $file) {
            if ($file !== '.' && $file !== '..') {
                $path = substr($dir, -1) === '/' ? "$dir$file" : "$dir/$file";
                $total += do_scan($path);
            }
        }

        print "$total\t$dir\n";
    }

    return $total;
};

array_shift($argv);
foreach ($argv as $arg)
    do_scan($arg);

